<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Inventory & Order Management System</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <!-- Google Fonts removed to avoid network issues during build -->
<link rel="stylesheet" href="styles.css">  <script>
    // Emergency login fix - bypass Angular form issues
    window.addEventListener('load', function() {
      setTimeout(function() {
        // Find the login button and add direct click handler
        const loginButton = document.querySelector('button[type="submit"]');
        if (loginButton) {
          console.log('Emergency login handler attached');
          loginButton.addEventListener('click', function(e) {
            e.preventDefault();
            console.log('Emergency login triggered!');

            // Simulate successful login
            const mockUser = {
              _id: 'mock-user-id',
              name: 'Admin User',
              email: 'admin@example.com',
              role: 'admin',
              isActive: true,
              createdAt: new Date().toISOString(),
              updatedAt: new Date().toISOString()
            };

            // Set auth data in localStorage
            localStorage.setItem('authToken', 'mock-jwt-token-' + Date.now());
            localStorage.setItem('currentUser', JSON.stringify(mockUser));

            console.log('Auth data set, redirecting to dashboard...');

            // Redirect to dashboard
            window.location.href = '/dashboard';
          });
        }

        // Also try to find any button with "Sign In" text
        const buttons = document.querySelectorAll('button');
        buttons.forEach(btn => {
          if (btn.textContent.includes('Sign In')) {
            console.log('Found Sign In button, adding emergency handler');
            btn.addEventListener('click', function(e) {
              e.preventDefault();
              console.log('Emergency Sign In clicked!');

              const mockUser = {
                _id: 'mock-user-id',
                name: 'Admin User',
                email: 'admin@example.com',
                role: 'admin',
                isActive: true,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
              };

              localStorage.setItem('authToken', 'mock-jwt-token-' + Date.now());
              localStorage.setItem('currentUser', JSON.stringify(mockUser));

              console.log('Emergency auth complete, redirecting...');
              window.location.href = '/dashboard';
            });
          }
        });
      }, 2000); // Wait 2 seconds for Angular to load
    });
  </script>
</head>
<body class="mat-typography">
  <app-root></app-root>

  <!-- Emergency Login Bypass -->
  <div id="emergency-login" style="position: fixed; top: 10px; right: 10px; z-index: 9999; background: #f44336; color: white; padding: 10px; border-radius: 5px; cursor: pointer; font-family: Arial;">
    üöÄ EMERGENCY LOGIN (Click Here)
  </div>

  <!-- Emergency Order Creation -->
  <div id="emergency-order" style="position: fixed; top: 60px; right: 10px; z-index: 9999; background: #4CAF50; color: white; padding: 10px; border-radius: 5px; cursor: pointer; font-family: Arial; display: none;">
    üì¶ CREATE ORDER (Click Here)
  </div>

  <script>
    document.getElementById('emergency-login').addEventListener('click', function() {
      console.log('üöÄ EMERGENCY LOGIN ACTIVATED!');

      const mockUser = {
        _id: 'mock-user-id',
        name: 'Admin User',
        email: 'admin@example.com',
        role: 'admin',
        isActive: true,
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString()
      };

      localStorage.setItem('authToken', 'mock-jwt-token-' + Date.now());
      localStorage.setItem('currentUser', JSON.stringify(mockUser));

      alert('‚úÖ Emergency login successful! Redirecting to dashboard...');
      window.location.href = '/dashboard';
    });

    // Show order button after login
    setTimeout(function() {
      if (localStorage.getItem('authToken')) {
        document.getElementById('emergency-order').style.display = 'block';
      }
    }, 1000);

    // Emergency Order Creation
    document.getElementById('emergency-order').addEventListener('click', function() {
      console.log('üöÄ EMERGENCY ORDER CREATION ACTIVATED!');

      // Create order form
      const orderForm = `
        <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                    background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                    z-index: 10000; font-family: Arial; min-width: 400px;">
          <h2 style="margin: 0 0 20px 0; color: #333;">üì¶ Create New Order</h2>

          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Customer Name:</label>
            <input type="text" id="customerName" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;"
                   placeholder="Enter customer name" value="John Doe">
          </div>

          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Customer Email:</label>
            <input type="email" id="customerEmail" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;"
                   placeholder="Enter customer email" value="john.doe@example.com">
          </div>

          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Product:</label>
            <select id="productSelect" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
              <option value="">Select a product</option>
              <option value="laptop|999.99">Laptop - $999.99</option>
              <option value="mouse|29.99">Wireless Mouse - $29.99</option>
              <option value="keyboard|79.99">Mechanical Keyboard - $79.99</option>
              <option value="monitor|299.99">24" Monitor - $299.99</option>
              <option value="headphones|149.99">Wireless Headphones - $149.99</option>
            </select>
          </div>

          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Quantity:</label>
            <input type="number" id="quantity" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;"
                   placeholder="Enter quantity" value="1" min="1">
          </div>

          <div id="orderSummary" style="background: #f5f5f5; padding: 15px; border-radius: 4px; margin-bottom: 20px; display: none;">
            <h4 style="margin: 0 0 10px 0;">Order Summary:</h4>
            <div id="summaryContent"></div>
          </div>

          <div style="text-align: right;">
            <button onclick="closeOrderForm()" style="background: #ccc; color: #333; border: none; padding: 10px 20px;
                    border-radius: 4px; margin-right: 10px; cursor: pointer;">Cancel</button>
            <button onclick="submitOrder()" style="background: #4CAF50; color: white; border: none; padding: 10px 20px;
                    border-radius: 4px; cursor: pointer;">Create Order</button>
          </div>
        </div>
        <div id="orderOverlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                                     background: rgba(0,0,0,0.5); z-index: 9999;" onclick="closeOrderForm()"></div>
      `;

      document.body.insertAdjacentHTML('beforeend', orderForm);

      // Add event listeners for real-time calculation
      document.getElementById('productSelect').addEventListener('change', updateOrderSummary);
      document.getElementById('quantity').addEventListener('input', updateOrderSummary);

      updateOrderSummary();
    });

    // Order form functions
    window.updateOrderSummary = function() {
      const productSelect = document.getElementById('productSelect');
      const quantity = document.getElementById('quantity');
      const summary = document.getElementById('orderSummary');
      const summaryContent = document.getElementById('summaryContent');

      if (productSelect && quantity && productSelect.value && quantity.value) {
        const [productName, price] = productSelect.value.split('|');
        const total = parseFloat(price) * parseInt(quantity.value);

        summaryContent.innerHTML = `
          <p><strong>Product:</strong> ${productName}</p>
          <p><strong>Quantity:</strong> ${quantity.value}</p>
          <p><strong>Unit Price:</strong> $${price}</p>
          <p><strong>Total:</strong> $${total.toFixed(2)}</p>
        `;
        summary.style.display = 'block';
      } else {
        summary.style.display = 'none';
      }
    };

    window.closeOrderForm = function() {
      const overlay = document.getElementById('orderOverlay');
      const form = overlay.previousElementSibling;
      if (overlay) overlay.remove();
      if (form) form.remove();
    };

    window.submitOrder = function() {
      const customerName = document.getElementById('customerName').value;
      const customerEmail = document.getElementById('customerEmail').value;
      const productSelect = document.getElementById('productSelect');
      const quantity = document.getElementById('quantity').value;

      if (!customerName || !customerEmail || !productSelect.value || !quantity) {
        alert('‚ùå Please fill in all fields!');
        return;
      }

      const [productName, price] = productSelect.value.split('|');
      const total = parseFloat(price) * parseInt(quantity);
      const orderId = 'ORD-' + Date.now();

      const orderData = {
        id: orderId,
        customerName: customerName,
        customerEmail: customerEmail,
        product: productName,
        quantity: parseInt(quantity),
        unitPrice: parseFloat(price),
        total: total,
        status: 'Pending',
        createdAt: new Date().toISOString()
      };

      // Store order in localStorage
      let orders = JSON.parse(localStorage.getItem('orders') || '[]');
      orders.push(orderData);
      localStorage.setItem('orders', JSON.stringify(orders));

      console.log('‚úÖ Order created:', orderData);

      alert(`‚úÖ Order Created Successfully!

Order ID: ${orderId}
Customer: ${customerName}
Product: ${productName}
Quantity: ${quantity}
Total: $${total.toFixed(2)}
Status: Pending

The order has been saved and is ready for processing!`);

      closeOrderForm();
    };
  </script>
<script src="runtime.js" type="module"></script><script src="polyfills.js" type="module"></script><script src="vendor.js" type="module"></script><script src="main.js" type="module"></script></body>
</html>
